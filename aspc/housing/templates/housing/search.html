{% extends 'housing/base.html' %}
{% load room_tools %}
{% block head %}
{% endblock head %}
{% block action_title %}search{% endblock action_title %}

{% block action_content %}
<div id="search_control" class="{% if result_view %}result_view{% else %}begin_view{% endif %}">
	<form action="." method="GET">
		{% for field in form %}
			<div class="section"><h3>{{ field.label }}</h3>
				<div class="disclosure">{{ field }} {{ field.help_text }} {{ field.errors }}</div>
			</div>
		{% endfor %}
		<p><input type="submit" value="search"></p>
		
	</form>
</div>

{% if result_view %}
<div id="search_results">
	<div id="map_container"></div>
	<table class="results">
		<tr>
			<th>room number</th>
			<th>floor</th>
			<th>ft<sup>2</sup></th>
			<th>occupancy</th>
			<th>average rating</th>
		</tr>
		{% for room in rooms %}
			<tr>
				<td><a href="{% url "housing_browse_room" room.floor.building.shortname room.floor.number room.number %}">{{ room.floor.building.name }} {{ room.number }}</a></td>
				<td>{{ room.floor.get_number_display }}</td>
				<td>{{ room.size|floatformat }}</td>
				<td>{{ room.get_occupancy_display }}</td>
				<td>{% if room.average_rating %}{% show_stars room.average_rating %}{% else %}no ratings yet{% endif %}</td>
			</tr>
		{% empty %}
		<tr><td colspan="4" class="empty">No matching rooms.</td></tr>
		{% endfor %}
	</table>
	</div>
{% endif %}
{% endblock action_content %}